jobs:

  test:
    docker:
      - image: circleci/python:3.6.2-stretch-browsers  
    steps:
      - checkout
      - run:
        name: test step 1
        command: echo "test step 1" >>ttt.txt
      - run:
        name: test step 2
        command:  more ttt.txt    
  build:
    docker:
      - image: circleci/python:3.6.2-stretch-browsers  
    steps:
      - checkout
      - run:
        name: step 1
        command: echo "build step 1" >>ttt.txt
      - run:
        name: step 2
        command:  more ttt.txt     
      
  deploy:

    docker:
      - image: circleci/python:3.6.2-stretch-browsers
      
      
    steps:
      - checkout
      - run:
          name: step 1
          command: echo "deploy step 1" >>ttt.txt
      - run:
          name: step 2
          command:  more ttt.txt
          # sudo bash -c "yes | add-apt-repository ppa:jonathonf/python-3.6 && apt-get update && apt-get install -y python3.6"
          
      - run:
          name: Release cocoapods
          command: python3 cocoapods_release.py

workflows:
  version: 2
  build_and_test:
    jobs:
      - test:
          filters:
            branches:
              only: master          
      - build:
          filters:
            branches:
              only: master      
      - deploy:
          filters:
            branches:
              ignore: /.*/
            tags:
              only: /^[0-9]+.[0-9]+.[0-9]+$/
